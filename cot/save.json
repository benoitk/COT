{
    "fr_FR_analyser" : "COT",
    "en_EN_analyser" : "TOC",
    "version":"0.0.0",

    "network" : [
        {"name":"eth0", "type":"ethernet", "address" : "192.168.1.2"},
        {"name":"uart0", "type":"uart", "baudrate":115000, "stop":1, "data":8},
        {"name":"uart1", "type":"uart", "baudrate":9600, "stop":1, "data":8}
    ],

    "com_automate":[
        {"type":"tcpip", "network":"eth0", "port":533},
        {"type":"jbus_over_tcpip", "slave":2, "network":"eth0", "port":532},
        {"name":"hart_over_tcpip", "network":"eth0", "port":658},
        {"type":"jbus", "slave":2, "network":"uart1"}

    ],
    "extensions" : [
        {"name" : "measure_card_1","fr_FR" : "Carte measure 1", "en_EN" : "Measure card 1",
            "com" : {"type":"jbus_over_tcpip", "slave":1 , "ip":"192.168.1.5", "port":245, "network":"eth0"} ,
            "organs" : [{"name":"measure_cell", "type":"input_float", "address_data":"0x0001"},
                          {"name":"heater", "type":"output_float", "address_data":"0x0002"},
                          {"name":"motor1", "type":"output_integer", "address_data":"0x0002"},
                          {"name":"motor2", "type":"output_integer", "address_data":"0x0002"},
                          {"name":"speed_pump2", "type":"output_integer", "address_data":"0x0003"},
                          {"name":"conf_pump1", "type":"output_integer", "address_data":"0x0004"},
                          {"name":"conf_pump2", "type":"output_integer", "address_data":"0x0005"},
                          {"name":"cmd_pump1", "type":"output_bit", "address_data":"0x0006"},
                          {"name":"cmd_pump2", "type":"output_bit", "address_data":"0x0007"}]
        },
        {"name" : "io_card_1","fr_FR" : "Carte E/S 1", "en_EN" : "I/O card 1",
            "com" : {"type":"jbus_over_tcpip", "slave":2, "ip":"192.168.1.3", "port":245, "network":"eth0" },
            "organs" : [{"name":"output_1", "type":"output_bit", "address_data":"0x0001", "passif":true},
                       {"name":"output_2", "type":"output_bit", "address_data":"0x0002", "passif":true},
                       {"name":"output_3", "type":"output_bit", "address_data":"0x0003", "passif":true},
                       {"name":"output_4", "type":"output_bit", "address_data":"0x0004", "passif":true},
                       {"name":"output_5", "type":"output_bit", "address_data":"0x0005", "passif":true},
                       {"name":"measure_temperature", "type":"input_float", "address_data":"0x00010"},
                       {"name":"input_2",  "type":"input_bit", "address_data":"0x0011", "passif":true},
                       {"name":"input_3",  "type":"input_bit", "address_data":"0x0011", "passif":true},
                       {"name":"input_4",  "type":"input_bit", "address_data":"0x0011", "passif":true}]
        },
        {"name" : "io_card_2","fr_FR" : "Carte E/S 2", "en_EN" : "I/O card 2",
            "com" : {"type":"jbus", "slave":3, "network":"uart0"},
            "organs" : [{"name":"output_1", "type":"output_bit", "address_data":"0x0001"},
                       {"name":"input_1",  "type":"input_bit", "address_data":"0x0011"}]
        },
        {"name" : "measure_card_2","fr_FR" : "Carte E/S 2", "en_EN" : "I/O card 2",
            "com" : {"type":"jbus", "slave":4, "network":"uart1"},
            "organs" : [{"name":"output_1", "type":"output_bit", "address_data":"0x0001"},
                       {"name":"input_1",  "type":"input_bit", "address_data":"0x0011"}]
        }
    ],


    "units":[{"name":"g_l", "fr_FR":"g/l"}, {"name":"mg_l", "fr_FR":"mg/l"}, {"name":"µg_l", "fr_FR":"µg/l"}, {"name":"tr_min", "fr_FR":"tr/min"},
             {"name":"deg_celsius", "fr_FR":"°C"}, {"name":"deg_fahrenheit", "fr_FR":"°F"}, {"name":"kelvin", "fr_FR":"K"}
    ],

    "units_convertion":[{"source":"g_l", "target":"mg_l", "type":"coef", "coef":0.001},
                        {"source":"g_l", "target":"µg_l", "type":"coef","coef":0.0001},
                        {"source":"mg_l", "target":"g_l", "type":"coef","coef":1000},
                        {"source":"mg_l", "target":"µg_l", "type":"coef","coef":0.1},
                        {"source":"µg_l", "target":"g_l", "type":"coef","coef":10000},
                        {"source":"µg_l", "target":"mg_l", "type":"coef","coef":10},
                        {"source":"deg_fah", "target":"deg_cel", "type":"offset_coef", "offset":-32, "coef":0.555555},
                        {"source":"deg_fah", "target":"kelvin", "type":"offset_coef", "offset":458.67, "coef":0.555555},
                        {"source":"deg_cel", "target":"deg_fah", "type":"coef_offset", "offset":32, "coef":1.8},
                        {"source":"deg_cel", "target":"kelvin", "type":"offset", "offset":273.15},
                        {"source":"kelvin", "target":"deg_fah", "type":"coef_offset", "offset":-458.67, "coef":1.8},
                        {"source":"kelvin", "target":"deg_cel", "type":"offset", "offset":-273.15}

    ],

    "variables" : [ {"name":"test_entee", "fr_FR" : "test entrée 1", "en_EN" : "test input 1", "type":"boolean", "value" : 1, "unit":"mg_l"},
                    {"name":"speed_pump_30rpm", "fr_FR" : "test entrée 1", "en_EN" : "test input 1", "type":"integer", "value" : 30, "unit":"tr_min"},
                    {"name":"direction_pump_trigo", "fr_FR" : "test entrée 1", "en_EN" : "test input 1", "type":"integer", "value" : true, "unit":"tr_min"},
                    {"name":"direction_pump_antitrigo", "fr_FR" : "test entrée 1", "en_EN" : "test input 1", "type":"integer", "value" : false, "unit":"tr_min"},
                    {"name":"test_ev_A", "fr_FR" : "entrée 1", "en_EN" : "input 1", "type":"boolean", "value" : 1},
                    {"name":"entree_ana", "fr_FR" : "entrée analogique 1", "en_EN" : "analog input 1", "type":"input_float",
                            "value" : 0, "extension_name":"measure_card_1", "organ_name":"measure_cell"
                    },
                    {"name":"ev_1", "fr_FR" : "sortie EV", "en_EN" : "analog input 1", "type":"output_boolean",
                            "value" : 0, "extension_name":"io_card_1", "organ_name":"output_1"
                    },
                    {"name":"ev_2", "fr_FR" : "sortie EV", "en_EN" : "analog input 1", "type":"output_boolean",
                            "value" : 0, "extension_name":"io_card_1", "organ_name":"output_2"
                    },
                    {"name":"actionneur_1", "fr_FR" : "sortie EV", "en_EN" : "analog input 1", "type":"output_boolean",
                            "value" : 0, "extension_name":"io_card_1", "organ_name":"output_3"
                    },
                     {"name":"actionneur_2", "fr_FR" : "sortie EV", "en_EN" : "analog input 1", "type":"output_boolean",
                            "value" : 0, "extension_name":"io_card_1", "organ_name":"output_4"
                    },
                    {"name":"aff_measure_1", "fr_FR" : "measure", "en_EN" : "measure", "type":"float", "format":"%f7.2",
                            "value" : 0, "extension_name":"ecran", "organ_name":"donnee_ecran_principale_measure_1"
                    },
                    {"name":"aff_measure_2", "fr_FR" : "measure", "en_EN" : "measure", "type":"float",
                            "value" : 0, "extension_name":"ecran", "organ_name":"donnee_ecran_principale_measure_2"
                    },
                    {"name":"cellule_measure", "fr_FR":"cellule de measure", "type":"input_float","format":"%f7.2",
                            "value":0, "extension_name":"measure_card_1", "organ_name":"measure_cell"
                    },
                    {"name":"cellule_temperature", "fr_FR":"cellule de température", "type":"input_float","format":"%f7.2",
                            "value":0, "extension_name":"measure_card_1", "organ_name":"measure_temperature", "unit":"deg_cel"
                    },
                    {"name":"coef_test", "fr_FR":"Coeff", "type":"float", "value":0.2},
                    {"name":"measure_silice", "fr_FR":"Silice", "type":"float", "value":0, "unit":"µg_l"},
                    {"name":"stream_en_cours", "fr_FR":"Silice", "type":"integer", "value":0},
                    {"name":"stream_1_state", "type":"boolean", "address":"0x00012"},
                    {"name":"num_pump1", "type":"integer", "value":3},
                    {"name":"selecteur_position_stream1", "type":"integer", "value":18},
                    {"name":"selecteur_position_stream2", "type":"integer", "value":48},
                    {"name":"etalon_reference", "type":"float", "value":0.244},
                    {"name":"etalon_precedent", "type":"float", "value":2.48},
                    {"name":"cmd_pump1", "type":"boolean", "value":false},
                    {"name":"stream_1_state", "type":"boolean", "value":false},
                    {"name":"alarm_defaut_eau_stream1","fr_FR":"Defaut d'eau", "type":"boolean", "value":false},
                    {"name":"alarm_defaut_eau_stream2","fr_FR":"Defaut d'eau", "type":"boolean", "value":false},
                    {"name":"speed_pump1", "fr_FR":"speed_pump1", "type":"output_integer",
                            "value":30, "extension_name":"measure_card_1", "organ_name":"cmd_pump1", "unit":"tr_min"
                    },
                    {"name":"conf_pump1", "fr_FR":"conf_pump1", "type":"output_integer",
                            "value":0, "extension_name":"measure_card_1", "organ_name":"conf_pump1"
                    },
                    {"name":"cmd_pump2", "type":"output_boolean", "value":false},
                    {"name":"speed_pump2", "fr_FR":"speed_pump1", "type":"output_integer",
                            "value":30, "extension_name":"measure_card_1", "organ_name":"cmd_pump2", "unit":"tr_min"
                    },
                    {"name":"conf_pump2", "fr_FR":"conf_pump2", "type":"output_integer",
                            "value":0, "extension_name":"measure_card_1", "organ_name":"conf_pump2"
                    },
                    {"name":"selection_stream1", "fr_FR":"selection_stream1", "type":"input_boolean",
                            "extension_name":"measure_card_1", "organ_name":"input_2"
                    },
                    {"name":"arret_fin_cycle", "fr_FR":"conf_pump2", "type":"input_boolean",
                            "extension_name":"measure_card_1", "organ_name":"input_3"
                    },
                    {
                        "name":"pompe_1", "fr_FR":"Rhodol", "type":"struct_pump_step_by_step",
                        "num_pump":"num_pump1", "speed":"speed_pump1", "conf":"conf_pump1"
                    }
    ],

    "display":{
        "diagnostic":["cellule_measure", "cellule_temperature"],
        "elec_tests":[{"name":"tab_EV", "variables":["ev_1", "ev_2"]},
                     {"name":"tab_Actionneurs", "variables":["actionneur_1", "actionneur_2"]},
                     {"name":"tab_entrees", "variables":["selection_stream1", "arret_fin_cycle"]},
                     {"name":"tab_pump", "variables":["pompe_1", "pompe_2"]},
                     {"name":"tab_selecteur","variables":["selecteur_position_stream1", "selecteur_position_stream2"],"pump":"pompe_2"  }
        ],
        "options":["consigne_teperature", "nombre_cycle_avant_calib", "seuil_measure"],
        "history":["measure_1","status"],
        "alarms":["alarm_defaut_eau_stream1","alarm_defaut_eau_stream2"]

    },

    "streams" : [{"fr_FR":"stream 1", "variables":["status", "defaut_eau"], "active_state": "stream_1_state",
                    "measures":[{"fr_FR":"var relative a measure 1", "variables":[{"name":"coeff", "type":"standard"}, {"name":"measure_silice", "type":"measure"}]},
                       {"fr_FR":"var relative a measure 2", "variables":[{"name":"coeff_2", "type":"standard"}, {"name":"measure_silice_2", "type":"measure"}]}
                    ],
                    "cycles":["maintenance_1", "zero_1", "cycle_measure_cot_stream1"]

                },
            {"fr_FR":"stream 2", "variables":["var_stream", "measure"],
            "measures":[{"fr_FR":"measure 1", "variables":["var_measure", "var_measure"]},
                       {"fr_FR":"measure 2", "variables":["var_measure", "var_measure"]}

            ],
            "cycles":["maintenance_2"]

            }
    ],


    "binds" : [
        {"source":"test_entee", "target":"test_ev_A"},
        {"source":"measure_1", "target":"aff_measure_2"},
        {"source":"aff_measure_2", "target":"measure_1"},
        {"source":"measure_2", "target":"aff_measure_1"}

    ],

    "actions" : [
                {
                    "name":"calcul_measure_stream_1",
                    "type":"calcul_measure",
                    "fr_FR":"Calcul de measure stream 1",
                    "variable_entre_cell":"cellule_measure",
                    "variable_entre_coeff":"coef_test",
                    "variable_sortie_measure":"measure_1"
                },
                {
                    "name":"calcul_measure_stream_2",
                    "type":"calcul_measure",
                    "fr_FR":"Calcul de measure",
                    "variable_entre_cell":"cellule_measure",
                    "variable_entre_coeff":"coef_test",
                    "variable_sortie_measure":"measure_2"
                },
                {
                    "name" : "4_tour_pompe_2",
                    "type" : "cmd_pump",
                    "fr_FR" : "4 tours de pompes 2",
                    "en_EN" : "4 tours of pumps 2",
                    "num_pump" : 2,
                    "speed_pump" : "speed_pump_30rpm",
                    "direction_trigo_pump" : "direction_pump_trigo",
                    "num_step_or_tour_pump" : 4,
                    "cmd_step_by_step_pump" : false,
                    "cmd_continu_pump" : false
                },
                {
                    "name" : "ouverture_ev_stream1",
                    "type" : "cmd_relay",
                    "fr_FR" : "Fermeture EV 1",
                    "en_EN" : "Close EV 1",
                    "target" : "output_ev"

                },
                {
                    "name" : "ouverture_ev_stream2",
                    "type" : "cmd_relay",
                    "fr_FR" : "Fermeture EV 1",
                    "en_EN" : "Close EV 1",
                    "target" : "output_ev"

                },
                {
                    "name" : "bloc_rincage",
                    "type" : "bloc",
                    "fr_FR" : "6 tours de pompes 2",
                    "en_EN" : "6 tours of pumps 2",
                    "steps" : [{"step":1, "name":"read_input_1_card_io_1"}, {"step":2, "name":"read_input_2_card_io_1"}, {"step":5, "name":"read_all_input_card_io_1"}]

                },
                {
                    "name":"read_input_1_card_io_1",
                    "type":"cmd_read_input",
                    "fr_FR" : "Lecture entrée 1 sur carte E/S 1",
                    "en_EN" : "Read input 1 on I/O card 1",
                    "target" : "test_entee"
                },
                {
                    "name":"calcul coef",
                    "type":"cal_coef",
                    "fr_FR" : "Lecture entrée 1 sur carte E/S 1",
                    "en_EN" : "Read input 1 on I/O card 1",
                    "variable_entre_concentration_avant" : "coef_test",
                    "variable_sortie_concentration" : "coef_actuel"
                },
                 {
                    "name":"report_coeff_calcule",
                    "type":"report_coeff",
                    "fr_FR" : "Lecture entrée 1 sur carte E/S 1",
                    "en_EN" : "Read input 1 on I/O card 1",
                    "variable_entre" : "coeff_calcule",
                    "variable_sortie" : "coef_actuel"
                }
    ],

    "cycles" : [
        {
            "name" : "maintenance_1",
            "fr_FR" : "Cycle de lecture de la carte E/S 1",
            "en_EN" : "Reading cycle on I/O card 1",
            "type":"autonome",
            "steps" : [{"step":1, "fr_FR":"Init", "actions":["read_input_1_card_io_1", "read_input_1_card_io_1"] }, {"step":2, "name":"read_input_2_card_io_1"}, {"step":5, "name":"read_all_input_card_io_1"},{"step":"stop", "name":"action_bidule"},{"step":"stop", "name":"action_machin"}]
        },
        {
            "name" : "cycle_pause_0",
            "fr_FR" : "En pause",
            "en_EN" : "Paused",
            "type" : "pause",
            "timer" : 10
        },
        {
            "name" : "cycle_pause_1",
            "fr_FR" : "En pause",
            "en_EN" : "Paused",
            "type" : "pause",
            "timer" : 3
        },
        {
            "name" : "cycle_measure_cot_stream1",
            "fr_FR" : "measure de COT",
            "en_EN" : "measure of TOC",
            "type" : "measure",
            "steps" : [{"step":1,"fr_FR":"Init", "actions":["ouverture_ev_stream1"]}, {"step":4, "actions":["fermeture_ev_1","4_tour_pompe_2"]}, {"step":6, "name":"6_tour_pompe_2"}, {"step":12, "name":"fermeture_ev_1"}, {"step":25, "name":"6_tour_pompe_2"}]
        },
        {
            "name" : "cycle_measure_cot_stream2",
            "fr_FR" : "measure de COT",
            "en_EN" : "measure of TOC",
            "type" : "measure",
            "steps" : [{"step":1,"name":"ouverture_ev_stream2"}, {"step":4, "name":"fermeture_ev_1"}, {"step":4, "name":"4_tour_pompe_2"}, {"step":6, "name":"6_tour_pompe_2"}, {"step":12, "name":"fermeture_ev_1"}, {"step":25, "name":"6_tour_pompe_2"}]
        },
        {
            "name" : "cycle_measure_1",
            "fr_FR" : "measure de COT 2",
            "en_EN" : "measure of TOC 2",
            "type" : "measure",
            "steps" : [{"step":1, "name":"4_tour_pompe_2"}, {"step":6, "name":"6_tour_pompe_2"}]
        },
        {
            "name" : "cycle_measure_2",
            "fr_FR" : "measure de COT 2",
            "en_EN" : "measure of TOC 2",
            "type" : "maintenance",
            "parameter_input":["etalon_reference"],
            "parameter_output":["coeff_actuel", "coeff_calcule"],
            "action_de_fin":"report_coeff_calcule",
            "steps" : [ {"step":1, "name":"4_tour_pompe_2"}, {"step":3, "name":"6_tour_pompe_2"}]
        }

    ],

     "scheduler" : [
        {"cycle" :"cycle_measure_cot_stream1", "nb_cycle" : 2},
        {"cycle" :"cycle_measure_1", "nb_cycle" : 1},
        {"cycle" :"cycle_measure_cot", "nb_cycle" : 3},
        {"cycle" :"cycle_pause_0", "nb_cycle" : 1}
    ]


}
